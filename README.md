# 1μ£Όμ°¨ κ³Όμ 
## μ£Όμ : TDDλ΅ κ°λ°ν•κΈ°
> μΌμ •: 2024λ…„ 12μ›” 14μΌ ~ 20μΌ
---
>### π“ TASK
>- [ ] κΈ°λ³Έ κµ¬ν„
>  - [ ] ν¬μΈνΈ μ¶©μ „
>    - [X] κΈ°λ¥ κµ¬ν„
>  - [ ] ν¬μΈνΈ μ‚¬μ©
>    - [ ] κΈ°λ¥ κµ¬ν„
>  - [ ] ν¬μΈνΈ μ΅°ν
>    - [ ] κΈ°λ¥ κµ¬ν„
>  - [ ] ν¬μΈνΈ λ‚΄μ—­ μ΅°ν
>    - [ ] κΈ°λ¥ κµ¬ν„
>- [ ] λ‹¨μ„ ν…μ¤νΈ κµ¬ν„
>  - [ ] ν¬μΈνΈ μ¶©μ „
>  - [ ] ν¬μΈνΈ μ‚¬μ©
>  - [ ] ν¬μΈνΈ μ΅°ν
>  - [ ] ν¬μΈνΈ λ‚΄μ—­ μ΅°ν
>- [ ] κΈ°λ³Έ κ³Όμ 
>  - [ ] ν¬μΈνΈ μ¶©μ „, μ‚¬μ© μ •μ±… μ¶”κ°€
>    - [ ] κΈ°λ¥ κµ¬ν„
>  - [ ] λ™μ‹μ„± μ μ–΄
>    - [ ] λ™μ‹μ„± μ μ–΄ μ„¤κ³„
>    - [ ] λ™μ‹μ„± μ μ–΄ κµ¬ν„
>    - [ ] λ™μ‹μ„± μ μ–΄ ν†µν•© ν…μ¤νΈ
>- [ ] μ‹¬ν™” κ³Όμ 
>  - [ ] λ™μ‹μ„± μ μ–΄ λ°©μ‹μ— λ€ν• λ¶„μ„ λ° λ³΄κ³ μ„ μ‘μ„±

# π“ κ°μ”
## 1οΈβƒ£ κ³Όμ  ν•„μ μ‚¬ν•­
- Nest.js μ κ²½μ° Typescript , Spring μ κ²½μ° Kotlin / Java μ¤‘ ν•λ‚λ΅ μ‘μ„±ν•©λ‹λ‹¤.
    - ν”„λ΅μ νΈμ— μ²¨λ¶€λ μ„¤μ • νμΌμ€ μμ •ν•μ§€ μ•λ„λ΅ ν•©λ‹λ‹¤.
- ν…μ¤νΈ μΌ€μ΄μ¤μ μ‘μ„± λ° μ‘μ„± μ΄μ λ¥Ό μ£Όμ„μΌλ΅ μ‘μ„±ν•λ„λ΅ ν•©λ‹λ‹¤.
- ν”„λ΅μ νΈ λ‚΄μ μ£Όμ„μ„ μ°Έκ³ ν•μ—¬ ν•„μ”ν• κΈ°λ¥μ„ μ‘μ„±ν•΄μ£Όμ„Έμ”.
- λ¶„μ‚° ν™κ²½μ€ κ³ λ ¤ν•μ§€ μ•μµλ‹λ‹¤.
- `/point` ν¨ν‚¤μ§€ (λ””λ ‰ν† λ¦¬) λ‚΄μ— `PointService` κΈ°λ³Έ κΈ°λ¥ μ‘μ„±
- `/database` ν¨ν‚¤μ§€μ κµ¬ν„μ²΄λ” μμ •ν•μ§€ μ•κ³ , μ΄λ¥Ό ν™μ©ν•΄ κΈ°λ¥μ„ κµ¬ν„
- κ° κΈ°λ¥μ— λ€ν• λ‹¨μ„ ν…μ¤νΈ μ‘μ„±
> μ΄ 4κ°€μ§€ κΈ°λ³Έ κΈ°λ¥ (ν¬μΈνΈ μ΅°ν, ν¬μΈνΈ μ¶©μ „/μ‚¬μ© λ‚΄μ—­ μ΅°ν, μ¶©μ „, μ‚¬μ©) μ„ κµ¬ν„ν•©λ‹λ‹¤.

## 2οΈβƒ£ κ³Όμ  μƒμ„Έ
`point` ν¨ν‚¤μ§€μ TODO μ™€ ν…μ¤νΈμ½”λ“λ¥Ό μ‘μ„±ν•΄μ£Όμ„Έμ”.

**μ”κµ¬ μ‚¬ν•­**  
ν¬μΈνΈ μ΅°ν, ν¬μΈνΈ μ¶©μ „/μ‚¬μ© λ‚΄μ—­ μ΅°ν, μ¶©μ „, μ‚¬μ©
```
- PATCH  `/point/{id}/charge` : ν¬μΈνΈλ¥Ό μ¶©μ „ν•λ‹¤.
- PATCH `/point/{id}/use` : ν¬μΈνΈλ¥Ό μ‚¬μ©ν•λ‹¤.
- GET `/point/{id}` : ν¬μΈνΈλ¥Ό μ΅°νν•λ‹¤.
- GET `/point/{id}/histories` : ν¬μΈνΈ λ‚΄μ—­μ„ μ΅°νν•λ‹¤.
```
- μ”κ³ κ°€ λ¶€μ΅±ν•  κ²½μ°, ν¬μΈνΈ μ‚¬μ©μ€ μ‹¤ν¨ν•μ—¬μ•Ό ν•©λ‹λ‹¤.
- λ™μ‹μ— μ—¬λ¬ κ±΄μ ν¬μΈνΈ μ¶©μ „, μ΄μ© μ”μ²­μ΄ λ“¤μ–΄μ¬ κ²½μ° μμ°¨μ μΌλ΅ μ²λ¦¬λμ–΄μ•Ό ν•©λ‹λ‹¤.

## 3οΈβƒ£ Pass μ΅°κ±΄
### β… κΈ°λ³Έκ³Όμ 
- ν¬μΈνΈ μ¶©μ „, μ‚¬μ©μ— λ€ν• μ •μ±… μ¶”κ°€ (μ”κ³  λ¶€μ΅±, μµλ€ μ”κ³  λ“±)
- λ™μ‹μ— μ—¬λ¬ μ”μ²­μ΄ λ“¤μ–΄μ¤λ”λΌλ„ μμ„λ€λ΅ (νΉμ€ ν•λ²μ— ν•λ‚μ μ”μ²­μ”©λ§) μ μ–΄λ  μ μλ„λ΅ λ¦¬ν©ν† λ§
- λ™μ‹μ„± μ μ–΄μ— λ€ν• ν†µν•© ν…μ¤νΈ μ‘μ„±
### β… μ‹¬ν™”κ³Όμ 
- λ™μ‹μ„± μ μ–΄ λ°©μ‹μ— λ€ν• λ¶„μ„ λ° λ³΄κ³ μ„ μ‘μ„± ( **README.md** )

---
# π“ μ‘μ—… κΈ°λ΅

## 1οΈβƒ£ ν”„λ΅μ νΈ ν…ν”λ¦Ώ λ¶„μ„ λ° μ”κ±΄ μ •μ
### β… ν…μ΄λΈ”
```
+--------------------+       +-----------------------------+
|   UserPointTable   |       |      PointHistoryTable      |
+--------------------+       +-----------------------------+
| PK  id             |<------| FK  userId                  |
|     point          |       | PK  id                      |
|     updateMillis   |       |     amount                  |
+--------------------+       |     type (TransactionType)  |
                             |     updateMillis            |
                             +-----------------------------+
```

### UserPointTable
|μ»¬λΌ λ…|νƒ€μ…|μ„¤λ…|
|---|---|---|
|id|long|μ‚¬μ©μ μ‹λ³„ id|
|point|long|ν•΄λ‹Ή μ‚¬μ©μμ μ”μ—¬ point|
|updateMillis|long|μ—…λ°μ΄νΈ μΌμ(λ°€λ¦¬μ΄ λ‹¨μ„, νƒ€μ„μ¤νƒ¬ν”„)|

### PointHistoryTable
|μ»¬λΌ λ…|νƒ€μ…|μ„¤λ…|
|---|---|---|
|id|long|νΈλμ­μ… μ‹λ³„ id|
|userId|long|μ‚¬μ©μ μ‹λ³„ id|
|amount|long|ν¬μΈνΈ λ³€κ²½ κΈμ•΅|
|type|TransactionType|νΈλμ­μ… μ ν• (CHARGE - μ¶©μ „, USE - μ‚¬μ©)|
|updateMillis|long|μ—…λ°μ΄νΈ μΌμ(λ°€λ¦¬μ΄ λ‹¨μ„, νƒ€μ„μ¤νƒ¬ν”„)|

### β… ν¬μΈνΈ νΈλμ­μ… μΆ…λ¥
| Type   | μ„¤λ… |
|--------|----|
| CHARGE | μ¶©μ „ |
|USE| μ‚¬μ© |

### β… API λ…μ„Έ λ° κΈ°λ¥ μ”κµ¬μ‚¬ν•­
### ν¬μΈνΈ μ΅°ν
- **Endpoint**
  - GET /{id}
- **Path Parameter**
  - id: (long) μ΅°νν•  μ μ €μ ID
- **Response**
  ```json
    {
      "id": 1,
      "point": 1000,
      "updateMillis": 1672531200000
    }
  ```
- **κΈ°λ¥ μ”κµ¬μ‚¬ν•­**
  - idλ΅ νΉμ • userμ ν¬μΈνΈ μ΅°ν
  - userκ°€ μ΅΄μ¬ν•μ§€ μ•μ„ κ²½μ° Exception λ°ν™
- **ν–‰λ™λ¶„μ„**
  - μ”μ²­: μ μ € IDλ¥Ό λ°›μ•„ ν•΄λ‹Ή μ μ €μ ν¬μΈνΈ μ •λ³΄λ¥Ό λ°ν™
  - λ™μ‘:
    1. idκ°€ μ ν¨ν• κ°’μΈμ§€ ν™•μΈ
    2. μ μ €κ°€ μ΅΄μ¬ν•λ”μ§€ ν™•μΈ
    3. μ μ €μ ν¬μΈνΈ μ •λ³΄λ¥Ό λ°ν™
- **λ‹¨μ„ ν…μ¤νΈ μΌ€μ΄μ¤**
  - μ„±κ³µ
    - μ μ €κ°€ μ΅΄μ¬ν•λ” κ²½μ° μ¬λ°”λ¥Έ ν¬μΈνΈ μ •λ³΄λ¥Ό λ°ν™ν•λ‹¤.(Service)
  - μ‹¤ν¨
    - idκ°€ μ£Όμ–΄μ§€μ§€ μ•μΌλ©΄ μ΅°νλ¥Ό μ‹¤ν¨ν•λ‹¤. - κ²€μ¦: idκ°€ μ—†λ” κ²½μ° Service νΈμ¶μ„ ν•μ§€ μ•λ”λ‹¤. (Controller)
    - μ£Όμ–΄μ§„ idκ°€ μ ν¨ν• κ°’μ΄ μ•„λ‹λ©΄ μ΅°νλ¥Ό μ‹¤ν¨ν•λ‹¤. - κ²€μ¦: id κ²€μ¦ validatorμ„ ν†µν•΄ Exception λ°ν™λ°›μ„ κ²½μ° μ΄ν›„ λ΅μ§μ΄ μ‹¤ν–‰λμ§€ μ•μΌλ©°, μ΅°ν μ‹¤ν¨. (Service)
    - μ μ €κ°€ μ΅΄μ¬ν•μ§€ μ•μΌλ©΄ μ΅°νλ¥Ό μ‹¤ν¨ν•λ‹¤. - κ²€μ¦: ν•΄λ‹Ή idλ¥Όκ°€μ§„ Userκ°€ μ—†λ” κ²½μ° Exceptionμ„ λ°ν™ν•λ©°, μ΅°ν μ‹¤ν¨ (Service)

### ν¬μΈνΈ μ¶©μ „/μ‚¬μ© λ‚΄μ—­ μ΅°ν
- **Endpoint**
    - GET /{id}/histories
- **Path Parameter**
    - id: (long) μ΅°νν•  μ μ €μ ID
- **Response**
  ```json
    [
      { 
        "id": 1,
        "userId": 1,
        "amount": 100,
        "updateMillis": 1672531200000,
        "type": "CHARGE"
      },
      { 
        "id": 2,
        "userId": 1,
        "amount": 100,
        "updateMillis": 1672531200000,
        "type": "USE"
      }
    ]
  ```
- **κΈ°λ¥ μ”κµ¬μ‚¬ν•­**
  - νΉμ • μ μ €μ ν¬μΈνΈ λ‚΄μ—­ μ΅°ν(μ¶©μ „ λ° μ‚¬μ© μ΄λ ¥)
  - λ‚΄μ—­μ΄ μ—†μ„ κ²½μ° λΉ λ°°μ—΄ λ°ν™
- **κ³ λ ¤μ‚¬ν•­**
  - λ°μ΄ν„° μ •λ ¬: λ‚ μ§λ¥Ό κΈ°μ¤€μΌλ΅ μµμ‹  μμΌλ΅ μ¶λ ¥
  - νμ΄μ§• μ²λ¦¬: ν…ν”λ¦Ώ μ†μ¤μ—μ„ μ κ³µν•λ” controllerμ—λ” νμ΄μ§• κ΄€λ ¨ νλΌλ―Έν„°κ°€ μ—†μΌλ―€λ΅ κµ¬ν„ μ μ™Έ
  - μ‹¤ν¨ν• λ‚΄μ—­ μ €μ¥: ν…ν”λ¦Ώ μ†μ¤μ—μ„ μ κ³µν•λ” λ°μ΄ν„°λ² μ΄μ¤λ” μ¶©μ „/μ‚¬μ© νƒ€μ… μ™Έ μ‹¤ν¨ λ‚΄μ—­μ„ μ €μ¥ν•  μ μλ” νƒ€μ…μ΄ μ—†μΌλ―€λ΅ κµ¬ν„ μ μ™Έ
  - μ μ €λ” μ΅΄μ¬ν•μ§€λ§ μ¶©μ „/μ‚¬μ© λ‚΄μ—­μ΄ μ—†λ” κ²½μ°: λΉ λ°°μ—΄ λ°ν™(κ΄€λ¦¬μμ— μν•΄ μ‚¬μ©μλ§ λ³„λ„ μ¶”κ°€ν•  μλ„ μμΌλ‹κΉ,, ν…ν”λ¦Ώ μ†μ¤ λ³€κ²½λ„ κµ³μ΄ ν•„μ” μ—†μΌλ‹κΉ κµ¬ν„)
- **ν–‰λ™ λ¶„μ„**
  - μ”μ²­: μ μ € IDλ¥Ό λ°›μ•„ ν•΄λ‹Ή μ μ €μ ν¬μΈνΈ μ¶©μ „/μ‚¬μ© λ‚΄μ—­ λ¦¬μ¤νΈλ¥Ό λ°ν™
  - λ™μ‘
    1. idκ°€ μ ν¨ν• κ°’μΈμ§€ ν™•μΈ
    2. μ μ €κ°€ μ΅΄μ¬ν•λ”μ§€ ν™•μΈ
    3. μ μ €μ λ‚΄μ—­μ΄ μμΌλ©΄ λ°ν™, μ—†μΌλ©΄ λΉ λ°°μ—΄μ„ λ°ν™
- **ν…μ¤νΈ μΌ€μ΄μ¤**
  - μ„±κ³µ
    - μ μ €κ°€ μ΅΄μ¬ν•λ©° λ‚΄μ—­μ΄ μμΌλ©΄ λ‚΄μ—­ λ¦¬μ¤νΈλ¥Ό λ°ν™ν•λ‹¤. (Service)
    - μ μ €κ°€ μ΅΄μ¬ν•μ§€λ§ λ‚΄μ—­μ΄ μ—†μΌλ©΄ λΉ λ°°μ—΄μ„ λ°ν™ν•λ‹¤. (Service)
  - μ‹¤ν¨
    - idκ°€ μ£Όμ–΄μ§€μ§€ μ•μΌλ©΄ μ΅°νλ¥Ό μ‹¤ν¨ν•λ‹¤. - κ²€μ¦: idκ°€ μ—†λ” κ²½μ° Service νΈμ¶μ„ ν•μ§€ μ•λ”λ‹¤. (Controller)
    - μ£Όμ–΄μ§„ idκ°€ μ ν¨ν• κ°’μ΄ μ•„λ‹λ©΄ μ΅°νλ¥Ό μ‹¤ν¨ν•λ‹¤. - κ²€μ¦: id κ²€μ¦ validatorμ„ ν†µν•΄ Exception λ°ν™λ°›μ„ κ²½μ° μ΄ν›„ λ΅μ§μ„ μ‹¤ν–‰ν•μ§€ μ•μΌλ©°, μ΅°ν μ‹¤ν¨. (Service)
    - μ μ €κ°€ μ΅΄μ¬ν•μ§€ μ•μΌλ©΄ μ΅°νλ¥Ό μ‹¤ν¨ν•λ‹¤. - κ²€μ¦: ν•΄λ‹Ή idλ¥Όκ°€μ§„ Userκ°€ μλ”μ§€ ν™•μΈ (Service)

### ν¬μΈνΈ μ¶©μ „
- **Endpoint**
    - PATCH /{id}/charge
- **Path Parameter**
    - id: (long) ν¬μΈνΈ μ¶©μ „ν•  μ μ €μ ID
    - amount: (long) μ¶©μ „ ν•  ν¬μΈνΈ
- **Response**
  ```json
    {
        "id": 1,
        "point": 1500,
        "updateMillis": 1672531500000
    }
  ```
- **κΈ°λ¥ μ”κµ¬μ‚¬ν•­**
  - μ”μ²­λ°›μ€ amountλ§νΌ μ μ €μ ν¬μΈνΈλ¥Ό μ¶©μ „.
  - μ¶©μ „ κΈμ•΅μ€ λ°λ“μ‹ 0λ³΄λ‹¤ μ»¤μ•Ό ν•¨.
- **κ³ λ ¤μ‚¬ν•­**
  - μ¶©μ „ μ‹¤ν¨ μ‹ λ΅¤λ°±: ν„μ¬ DB κµ¬ν„μ²΄λ” λ΅¤λ°±μ„ μ κ³µν•μ§€ μ•μΌλ―€λ΅ μ μ™Έ, μ”κ±΄μ„ μ¶©μ΅±ν•μ§€ μ•μΌλ©΄ λ°μ΄ν„° μ—…λ°μ΄νΈ λ΅μ§ μν–‰ν•μ§€ μ•λ„λ΅ κµ¬ν„
  - μµμ† μ¶©μ „ ν¬μΈνΈ μ •μ±…: 1μ›μ ν¬μΈνΈλ„ μ†μ¤‘ν•λ―€λ΅ 0 μ΄μƒμ΄λ©΄ λ¬΄μ΅°κ±΄ κ°€λ¥ν•λ„λ΅
  - μµμ΄ μ¶©μ „ν•λ” μ‚¬μ©μ(userTableμ— μ—†λ” μ‚¬μ©μ): μ‚¬μ©μ μ¶”κ°€
  - (μ¶”κ°€ λ²”μ„)μµλ€ μ”κ³  μ΄μƒ μ¶©μ „ λ¶κ°€: 10,000,000 ν¬μΈνΈ μ΄μƒ μ¶©μ „ λ¶κ°€
- **ν–‰λ™ λ¶„μ„**
  - μ”μ²­: μ μ € IDμ™€ μ¶©μ „ κΈμ•΅μ„ λ°›μ•„ ν¬μΈνΈλ¥Ό μ¶©μ „
  - λ™μ‘:
    1. μ…λ ¥λ idμ™€ amountκ°€ μ ν¨ν• κ°’μΈμ§€ ν™•μΈ(Validation)
    2. μ μ €κ°€ μ΅΄μ¬ν•  κ²½μ° ν„μ¬ μ μ €μ ν¬μΈνΈ μ΅°ν, μ μ €κ°€ μ΅΄μ¬ν•μ§€ μ•μ„ κ²½μ° 0 (Service)
       - μ μ €κ°€ μ΅΄μ¬ν•μ§€ μ•λ” κ²½μ° user λ“±λ΅μ„ ν•΄λ²„λ¦¬λ©΄, μ΄ν›„ λ΅μ§μ΄ μ‹¤ν¨ν•  κ²½μ° μ¶©μ „ νμ¤ν† λ¦¬ μ—…λ°μ΄νΈ λ“±μ— λ€ν• κ³ λ ¤μ‚¬ν•­μ΄ μ• λ§¤ν•λ‹¤κ³  νλ‹¨λμ–΄, μ μ € μ΅΄μ¬ν•μ§€ μ•μ„ κ²½μ° 0μΌλ΅ λ³€μμ— μ„ μ–Έ, μ΄ ν›„ κΈ°μ΅΄ μ μ € μμ„λ–„μ™€ λ™μΌν• μ‹μ μ— UserTableμ— λ“±λ΅ν•κΈ°λ΅ ν•¨
    3. ν¬μΈνΈ μ¶©μ „ μ‹ μµλ€ μ”κ³ λ¥Ό λ„λ”μ§€ ν™•μΈ(μ¶”κ°€ λ²”μ„)(Service)
    4. μ¶©μ „ κΈμ•΅μ„ ν¬μΈνΈμ— λ”ν• λ’¤ UserPointTable μ—…λ°μ΄νΈ(Service)
    5. μ¶©μ „ νμ¤ν† λ¦¬ PointHistoryμ— μ—…λ°μ΄νΈ(Service)
    6. μ—…λ°μ΄νΈλ ν¬μΈνΈ μ •λ³΄λ¥Ό λ°ν™(Service)
- **ν…μ¤νΈ μΌ€μ΄μ¤**
  - μ„±κ³µ
    - λ“±λ΅λμ–΄μλ μ μ €μ μ¶©μ „μΌ κ²½μ° κΈ°μ΅΄ ν¬μΈνΈ + μ”μ²­ ν¬μΈνΈκ°€ μ €μ¥λμ—λ”μ§€ ν™•μΈ (Service)
    - κΈ° λ“±λ΅λμ§€ μ•μ€ μ μ €μ μµμ΄ μ¶©μ „μΌ κ²½μ° μ”μ²­ ν¬μΈνΈ κΈμ•΅κ³Ό ν„μ¬ μ μ €μ ν¬μΈνΈκ°€ λ™μΌν•μ§€ ν™•μΈ (Service)
  - μ‹¤ν¨
    - idλ‚ amountκ°€ μ£Όμ–΄μ§€μ§€ μ•μΌλ©΄ μ¶©μ „μ„ μ‹¤ν¨ν•λ‹¤. - κ²€μ¦: idλ‚ amountκ°€ μ—†λ” κ²½μ° Service νΈμ¶μ„ ν•μ§€ μ•λ”λ‹¤. (Controller)
    - μ£Όμ–΄μ§„ idλ‚ amountκ°€ μ ν¨ν• κ°’μ΄ μ•„λ‹λ©΄ μ¶©μ „μ„ μ‹¤ν¨ν•λ‹¤. - κ²€μ¦: id, amount κ²€μ¦ validatorμ„ ν†µν•΄ Exception λ°ν™λ°›μ„ κ²½μ°, μ¶©μ „ μ‹¤ν¨. (Service)
    - μ¶©μ „ ν›„ ν¬μΈνΈκ°€ μµλ€ μ”κ³ λ¥Ό λ„μΌλ©΄ μ¶©μ „μ„ μ‹¤ν¨ν•λ‹¤.(μ¶”κ°€ λ²”μ„) κ²€μ¦: κΈ°μ΅΄ ν¬μΈνΈ + μ¶©μ „ ν¬μΈνΈκ°€ μµλ€ μ”κ³ λ¥Ό λ„μ„ κ²½μ° Exception λ°ν™ (Service)

### ν¬μΈνΈ μ‚¬μ©
- **Endpoint**
    - PATCH /{id}/use
- **Path Parameter**
    - id: (long) ν¬μΈνΈ μ‚¬μ©ν•  μ μ €μ ID
    - amount: (long) μ‚¬μ© ν•  ν¬μΈνΈ
- **Response**
  ```json
    {
        "id": 1,
        "point": 1500,
        "updateMillis": 1672531500000
    }
  ```
- **κΈ°λ¥ μ”κµ¬μ‚¬ν•­**
    - μ”μ²­λ°›μ€ amountλ§νΌ μ μ €μ ν¬μΈνΈλ¥Ό μ‚¬μ©.
    - μ‚¬μ© κΈμ•΅μ€ λ°λ“μ‹ 0λ³΄λ‹¤ μ»¤μ•Ό ν•¨.
- **κ³ λ ¤μ‚¬ν•­**
  - μ‚¬μ© μ‹¤ν¨ μ‹ λ΅¤λ°±: ν„μ¬ DB κµ¬ν„μ²΄λ” λ΅¤λ°±μ„ μ κ³µν•μ§€ μ•μΌλ―€λ΅ μ μ™Έ, μ”κ±΄μ„ μ¶©μ΅±ν•μ§€ μ•μΌλ©΄ λ°μ΄ν„° μ—…λ°μ΄νΈ λ΅μ§ μν–‰ν•μ§€ μ•λ„λ΅ κµ¬ν„
  - μµμ† μ‚¬μ© ν¬μΈνΈ μ •μ±…: 1μ›μ ν¬μΈνΈλ„ μ†μ¤‘ν•λ―€λ΅ 0 μ΄μƒμ΄λ©΄ λ¬΄μ΅°κ±΄ κ°€λ¥ν•λ„λ΅
  - (μ¶”κ°€ λ²”μ„)μ”μ—¬ μ”κ³  μ΄μƒ μ‚¬μ© λ¶κ°€
- **ν–‰λ™ λ¶„μ„**
    - μ”μ²­: μ μ € IDμ™€ μ‚¬μ© κΈμ•΅μ„ λ°›μ•„ ν¬μΈνΈ μ‚¬μ©
    - λ™μ‘:
      1. μ…λ ¥λ idμ™€ amountκ°€ μ ν¨ν• κ°’μΈμ§€ ν™•μΈ(Validation)
      2. μ μ €κ°€ μ΅΄μ¬ν•λ”μ§€ ν™•μΈ(Service)
      3. μ μ €μ ν„μ¬ ν¬μΈνΈ μ΅°ν(Service)
      4. ν¬μΈνΈ μ‚¬μ© κΈμ•΅μ΄ ν„μ¬ μ”κ³ λ¥Ό λ„λ”μ§€ ν™•μΈ(μ¶”κ°€ λ²”μ„)(Service)
      5. ν¬μΈνΈ μ°¨κ° ν›„ UserPointTable μ—…λ°μ΄νΈ(Service)
      6. μ°¨κ° νμ¤ν† λ¦¬ PointHistoryμ— μ—…λ°μ΄νΈ(Service)
      7. μ—…λ°μ΄νΈλ ν¬μΈνΈ μ •λ³΄λ¥Ό λ°ν™(Service)
- **ν…μ¤νΈ μΌ€μ΄μ¤**
  - μ„±κ³µ
    - μ μ €κ°€ μ΅΄μ¬ν•λ©° μ¶©λ¶„ν• μ”μ•΅μ΄ μμ„ κ²½μ° ν¬μΈνΈκ°€ μ •μƒμ μΌλ΅ μ°¨κ°λλ‹¤ (Service).
  - μ‹¤ν¨
    - idλ‚ amountκ°€ μ£Όμ–΄μ§€μ§€ μ•μΌλ©΄ μ¶©μ „μ„ μ‹¤ν¨ν•λ‹¤. - κ²€μ¦: idλ‚ amountκ°€ μ—†λ” κ²½μ° Service νΈμ¶μ„ ν•μ§€ μ•λ”λ‹¤. (Controller)
    - μ£Όμ–΄μ§„ idλ‚ amountκ°€ μ ν¨ν• κ°’μ΄ μ•„λ‹λ©΄ μ¶©μ „μ„ μ‹¤ν¨ν•λ‹¤. - κ²€μ¦: id, amount κ²€μ¦ validatorμ„ ν†µν•΄ Exception λ°ν™λ°›μ„ κ²½μ°, μ¶©μ „ μ‹¤ν¨. (Service)
    - μ μ €κ°€ μ΅΄μ¬ν•μ§€ μ•μΌλ©΄ μ‚¬μ©μ„ μ‹¤ν¨ν•λ‹¤. - κ²€μ¦: ν•΄λ‹Ή idλ¥Ό κ°€μ§„ Userκ°€ μλ”μ§€ ν™•μΈ (Service)
    - μ‚¬μ©κΈμ•΅μ΄ μ”κ³ λ¥Ό λ„μΌλ©΄ μ‚¬μ©μ„ μ‹¤ν¨ν•λ‹¤.(μ¶”κ°€ λ²”μ„) κ²€μ¦: μ‚¬μ© ν¬μΈνΈκ°€ μ”κ³ λ¥Ό λ„μΌλ©΄ Exception λ°ν™ (Service)

> **κ³ λ ¤μ‚¬ν•­ μ”μ•½**  
> - μ μ € μ΅΄μ¬ ν™•μΈ: ν¬μΈνΈ μ΅°ν, ν¬μΈνΈ μ΄λ ¥μ΅°ν, ν¬μΈνΈ μ‚¬μ©  
> - id, amount μ ν¨μ„±: μμ, μ«μκ°€ μ•„λ‹ κ²½μ° μ ν¨ν•μ§€ μ•μ

## 2οΈβƒ£ ν‚¤μ›λ“
### β… Given - When - Then ν¨ν„΄
- **Given**: μ¤€λΉ„: ν…μ¤νΈλ¥Ό μ„ν• μ¤€λΉ„, λ³€μ λ° Mock κ°μ²΄ μ •μ
- **When**: μ‹¤ν–‰: μ‹¤μ  κΈ°λ¥μ„ μν–‰ν•λ” ν…μ¤νΈ
- **Then**: κ²€μ¦: μμƒν• κ°’, μ‹¤μ  ν–‰λ™ κ²€μ¦

### β… @Mock, @InjectMocks
- **@Mock**
  - λ©μ : ν…μ¤νΈ λ€μƒ ν΄λμ¤μ μ™Έλ¶€ μμ΅΄μ„±(μ: DAO, Service λ“±)μ„ κ°€μ§(Mock) κ°μ²΄λ΅ λ§λ“¬
  - μ‚¬μ© μ΄μ : ν…μ¤νΈ μ¤‘ μ‹¤μ  κµ¬ν„μ²΄ λ€μ‹  Mock κ°μ²΄λ¥Ό μ£Όμ…ν•μ—¬ ν…μ¤νΈ λ²”μ„λ¥Ό μΆνκ³  λ…λ¦½μ μΌλ΅ ν…μ¤νΈν•κΈ° μ„ν•¨
  - νΉμ§•:
    - μ§μ ‘μ μΈ νΈμ¶λ§ ν—μ©ν•λ©°, μ„¤μ •λ λ™μ‘(when-thenReturn)λ§ μν–‰
    - μμ΅΄μ„±μ„ νΈμ¶ν•΄λ„ μ‹¤μ  λ΅μ§μ€ μ‹¤ν–‰λμ§€ μ•μ
- **@InjecMocks**
  - λ©μ : ν…μ¤νΈ λ€μƒ ν΄λμ¤μ μμ΅΄μ„±(ν•„λ“, μƒμ„±μ, setter)μ„ @MockμΌλ΅ μƒμ„±λ κ°μ²΄λ΅ μλ™ μ£Όμ… 
  - μ‚¬μ© μ΄μ : ν…μ¤νΈ λ€μƒ ν΄λμ¤μ μ‹¤μ  λ΅μ§μ„ μ‹¤ν–‰ν•λ©΄μ„λ„ μμ΅΄μ„±μ€ Mock κ°μ²΄λ΅ λ€μ²΄
  - νΉμ§•:
    - ν…μ¤νΈν•λ ¤λ” λ€μƒ ν΄λμ¤μ— μ‹¤μ  λ΅μ§μ„ μ‹¤ν–‰
    - Mock κ°μ²΄λ΅ μ£Όμ…λ μμ΅΄μ„±μ€ μ„¤μ •λ λ™μ‘λ§ μν–‰
> **@Mock, @InjectMocks μ°¨μ΄**  
> Mock κ°μ²΄λ” μ§μ ‘ νΈμ¶ν•΄μ„ λ™μ‘μ„ μ •μν•΄μ•Ό ν•κ³ , λ…λ¦½μ μΌλ΅ ν…μ¤νΈλ¨  
> - μμ΅΄μ„±κ³Ό μƒκ΄€μ—†μ΄ κ°€μ§ λ™μ‘λ§ ν…μ¤νΈν•λ ¤λ” κ²½μ° μ‚¬μ©  
> _λ‚΄κ°€ μ›ν•λ” λ΅λ΄‡μ„ λ§λ“¤μ–΄λ†“κ³ , "λ„λ” μ΄λ ‡κ² ν–‰λ™ν•΄!"λΌκ³  κµ¬μ²΄μ μΌλ΅ μ•λ ¤μ£Όλ” λλ‚_  
>
> InjectMocksλ” Mock κ°μ²΄λ¥Ό λ‚΄λ¶€μ μΌλ΅ μ£Όμ…λ°›μ•„ μ‹¤μ  λ΅μ§μ„ μ‹¤ν–‰  
> - ν…μ¤νΈ λ€μƒ λ΅μ§(Service)μ λ™μ‘μ„ ν™•μΈν•λ©΄μ„λ„, μμ΅΄μ„±(Repository)μ€ MockμΌλ΅ λ€μ²΄ν•μ—¬ μ μ–΄ κ°€λ¥.  
> _@InjectMocks: λ‚΄κ°€ ν…μ¤νΈν•λ ¤λ” μ‹¤μ  λ΅μ§(μ: UserService)μ„ μ‹¤ν–‰ν•μ§€λ§, κ·Έ λ΅μ§μ΄ μμ΅΄ν•λ” λ΅λ΄‡λ“¤(Mock)μ€ λ‚΄κ°€ μ›ν•λ” λ€λ΅ μ›€μ§μ΄κ² μ„¤μ •_  

### β… Mock κ²€μ¦(verify)
| **verify λ©”μ„λ“**                       | **μ„¤λ…**                           | **μμ **                                          |
|--------------------------------------|----------------------------------|-------------------------------------------------|
| `verify(mock)`                       | μ§€μ •λ Mock κ°μ²΄μ λ©”μ„λ“κ°€ νΈμ¶λμ—λ”μ§€ κ²€μ¦      | `verify(mock).method();`                        |
| `verify(mock, times(n))`             | νΉμ • λ©”μ„λ“κ°€ `n`λ² νΈμ¶λμ—λ”μ§€ κ²€μ¦           | `verify(mock, times(2)).method();`              |
| `verify(mock, never())`              | νΉμ • λ©”μ„λ“κ°€ ν• λ²λ„ νΈμ¶λμ§€ μ•μ•λ”μ§€ κ²€μ¦        | `verify(mock, never()).method();`               |
| `verify(mock, atLeast(n))`           | νΉμ • λ©”μ„λ“κ°€ μµμ† `n`λ² νΈμ¶λμ—λ”μ§€ κ²€μ¦        | `verify(mock, atLeast(2)).method();`            |
| `verify(mock, atMost(n))`            | νΉμ • λ©”μ„λ“κ°€ μµλ€ `n`λ² νΈμ¶λμ—λ”μ§€ κ²€μ¦        | `verify(mock, atMost(3)).method();`             |
| `verifyNoMoreInteractions(mock)`     | Mock κ°μ²΄μ— λ€ν•΄ λ” μ΄μƒ νΈμ¶λ λ©”μ„λ“κ°€ μ—†λ”μ§€ κ²€μ¦ | `verifyNoMoreInteractions(mock);`               |
| `verifyZeroInteractions(mock)`       | Mock κ°μ²΄μ— λ€ν•΄ μ–΄λ–¤ λ©”μ„λ“λ„ νΈμ¶λμ§€ μ•μ•λ”μ§€ κ²€μ¦ | `verifyZeroInteractions(mock);`                 |
| `verify(mock, timeout(ms))`          | μ§€μ •λ μ‹κ°„μ΄ μ§€λ‚κΈ° μ „μ— λ©”μ„λ“κ°€ νΈμ¶λμ—λ”μ§€ κ²€μ¦    | `verify(mock, timeout(500)).method();`          |
| `verify(mock, timeout(ms).times(n))` | νΉμ • μ‹κ°„ λ‚΄μ— λ©”μ„λ“κ°€ `n`λ² νΈμ¶λμ—λ”μ§€ κ²€μ¦     | `verify(mock, timeout(500).times(2)).method();` |

### β… JUnit λ‹¨μ •(assert)
| **assert λ©”μ„λ“**                           | **μ„¤λ…**                                           | **μμ **                                             |
|------------------------------------------|--------------------------------------------------|-----------------------------------------------------|
| `assertEquals(expected, actual)`         | λ‘ κ°’μ΄ λ™μΌν•μ§€ κ²€μ‚¬ν•©λ‹λ‹¤. λ™μΌν•μ§€ μ•μΌλ©΄ ν…μ¤νΈ μ‹¤ν¨                 | `assertEquals(5, add(2, 3));`                      |
| `assertNotEquals(expected, actual)`      | λ‘ κ°’μ΄ λ™μΌν•μ§€ μ•μ€μ§€ κ²€μ‚¬ν•©λ‹λ‹¤. λ™μΌν•λ©΄ ν…μ¤νΈ μ‹¤ν¨                 | `assertNotEquals(4, add(2, 3));`                   |
| `assertTrue(condition)`                  | μ΅°κ±΄μ΄ `true`μΈμ§€ κ²€μ‚¬ν•©λ‹λ‹¤. `false`μ΄λ©΄ ν…μ¤νΈ μ‹¤ν¨             | `assertTrue(isEven(4));`                           |
| `assertFalse(condition)`                 | μ΅°κ±΄μ΄ `false`μΈμ§€ κ²€μ‚¬ν•©λ‹λ‹¤. `true`μ΄λ©΄ ν…μ¤νΈ μ‹¤ν¨             | `assertFalse(isEven(5));`                          |
| `assertNull(object)`                     | κ°μ²΄κ°€ `null`μΈμ§€ κ²€μ‚¬ν•©λ‹λ‹¤. `null`μ΄ μ•„λ‹λ©΄ ν…μ¤νΈ μ‹¤ν¨           | `assertNull(findById(999));`                       |
| `assertNotNull(object)`                  | κ°μ²΄κ°€ `null`μ΄ μ•„λ‹μ§€ κ²€μ‚¬ν•©λ‹λ‹¤. `null`μ΄λ©΄ ν…μ¤νΈ μ‹¤ν¨           | `assertNotNull(findById(1));`                      |
| `assertSame(expected, actual)`           | λ‘ κ°μ²΄κ°€ λ™μΌν• μΈμ¤ν„΄μ¤μΈμ§€ κ²€μ‚¬ (κ°μ²΄μ μ°Έμ΅°λ¥Ό λΉ„κµ)                 | `assertSame(obj1, obj2);`                          |
| `assertNotSame(expected, actual)`        | λ‘ κ°μ²΄κ°€ λ™μΌν• μΈμ¤ν„΄μ¤κ°€ μ•„λ‹μ§€ κ²€μ‚¬                           | `assertNotSame(obj1, obj3);`                       |
| `assertArrayEquals(expected, actual)`    | λ‘ λ°°μ—΄μ΄ λ™μΌν•μ§€ κ²€μ‚¬, λ°°μ—΄μ κΈΈμ΄μ™€ λ‚΄μ©μ΄ λ¨λ‘ κ°™μ•„μ•Ό ν•¨              | `assertArrayEquals(new int[]{1, 2}, new int[]{1, 2});` |
| `assertThrows(expectedType, executable)` | νΉμ • μμ™Έκ°€ λ°μƒν–λ”μ§€ κ²€μ‚¬                                  | `assertThrows(IllegalArgumentException.class, () -> { throwException(); });` |
| `fail()`                                 | ν…μ¤νΈλ¥Ό κ°•μ λ΅ μ‹¤ν¨ μ²λ¦¬, μ£Όλ΅ κµ¬ν„ μμ •μ΄κ±°λ‚ μμƒ μ™Έμ κ²½λ΅λ¥Ό νƒμ§€ν•κΈ° μ„ν•΄ μ‚¬μ© | `fail("This test should fail");`                   |

> **verify, assert μ°¨μ΄**  
> assert(κ²°κ³Ό κ²€μ¦)
> - κ²°κ³Όλ¥Ό ν™•μΈν•λ” μƒνƒ κ²€μ¦μ΄ ν•„μ”ν• κ²½μ°.
> - νΉμ • μ…λ ¥μ— λ€ν• μ¶λ ¥ κ°’μ΄ μμƒλ κ°’μΈμ§€ ν™•μΈν•λ ¤κ³  ν•  λ•.
> 
> verify(ν–‰μ„ κ²€μ¦)
> - νΉμ • λ©”μ„λ“λ‚ κΈ°λ¥μ΄ μλ„λ€λ΅ νΈμ¶λμ—λ”μ§€ ν™•μΈν•λ ¤λ” κ²½μ°.
> - λ³µμ΅ν• μμ΅΄μ„±(μ: λ°μ΄ν„°λ² μ΄μ¤, μ„λΉ„μ¤ νΈμ¶ λ“±)μ΄ μλ” μ½”λ“μ—μ„ ν–‰μ„ κΈ°λ° ν…μ¤νΈκ°€ ν•„μ”ν•  λ•.